<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Wave-Flex Integrator</title>
  
  <meta
    http-equiv="Content-Security-Policy"
    content="
      default-src 'self'; 
      script-src 'self' https://cdnjs.cloudflare.com; 
      style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; 
      font-src 'self' https://cdnjs.cloudflare.com; 
      img-src 'self' https://cdnjs.cloudflare.com data:;
    "
  />
  
  <!-- Include Bootstrap CSS from CDNJS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" integrity="sha512-t4GWSVZO1eC8BM339Xd7Uphw5s17a86tIZIj8qRxhnKub6WoyhnrxeCIMeAqBPgdZGlCcG2PrZjMc+Wr78+5Xg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Include Bootstrap Icons from CDNJS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.3/font/bootstrap-icons.min.css" integrity="sha512-dPXYHHenicH9AgASjnT44v788xYV1e+I9K/zGf2yUaXlO9bT/fO+o27lKjB5q8tC1n9jC6A3C4z8+6m3K5yA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Include flag-icon-css from CDNJS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/6.6.6/css/flag-icons.min.css" integrity="sha512-uvXdJud8WaOlQFjlz9B15Yy2Au/bMAvz79F7Xa6OakCl2jvQPdHD0hb3dEqZRdSwG4/sknePXlE7GiarwA/9Wg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  
  <!-- Link to External Custom CSS -->
  <link rel="stylesheet" href="styles.css" />
  
</head>
<body>
  <div class="container-fluid">
    <img src="assets/wave-flex-integrator-banner-800x70.png" alt="Wave-Flex Integrator" class="banner-image" />
  
    <!-- Alert Container for Dynamic Messages -->
    <div id="alertContainer" class="mt-3"></div>
    
    <!-- Tab Navigation -->
    <ul class="nav nav-tabs" id="mainTab" role="tablist">
      <li class="nav-item" role="presentation">
        <a
          class="nav-link active"
          id="status-tab"
          data-bs-toggle="tab"
          href="#status"
          role="tab"
          aria-controls="status"
          aria-selected="true"
          >Status</a
        >
      </li>
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="config-tab"
          data-bs-toggle="tab"
          href="#config"
          role="tab"
          aria-controls="config"
          aria-selected="false"
          >Configuration</a
        >
      </li>
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="security-tab"
          data-bs-toggle="tab"
          href="#security"
          role="tab"
          aria-controls="security"
          aria-selected="false"
          >Security</a>
      </li>      
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="profiles-tab"
          data-bs-toggle="tab"
          href="#profiles"
          role="tab"
          aria-controls="profiles"
          aria-selected="false"
          >Profiles</a
        >
      </li>
         
      <!-- About Tab -->
      <li class="nav-item" role="presentation">
        <a
          class="nav-link"
          id="about-tab"
          data-bs-toggle="tab"
          href="#about"
          role="tab"
          aria-controls="about"
          aria-selected="false"
          >About</a
        >
      </li>
    </ul>
    
    <!-- Tab Contents -->
    <div class="tab-content" id="mainTabContent">
      
      <!-- Status Tab -->
      <div
        class="tab-pane fade show active"
        id="status"
        role="tabpanel"
        aria-labelledby="status-tab"
      >

      <!-- Status Content -->
        <div id="statusContent" class="mt-4">

          <!-- Quick Actions -->
          <div class="d-flex justify-content-end mb-3">
            <button id="openQSOAssistantBtn" class="btn btn-primary">
              <!-- Icon placeholder if you want one, e.g. <i class="bi bi-window"></i> -->
              Open QSO Assistant
            </button>
          </div>

          <!-- Connected Services Section -->
          <h3>Connected Services</h3>
          <div class="row">
            <!-- Row 1, Column 1: DX Cluster -->
            <div class="col-md-6">
              <ul class="list-group">
                <li class="list-group-item d-flex">
                  <span class="label-text">DX Cluster:</span>
                  <span id="dxClusterStatus" class="status-item">Disconnected</span>
                </li>
              </ul>
            </div>

            <!-- Row 1, Column 2: Wavelog API -->
            <div class="col-md-6">
              <ul class="list-group">
                <li class="list-group-item d-flex">
                  <span class="label-text">Wavelog Profile:</span>
                  <span id="wavelogApiStatus" class="status-item">Unknown</span>
                </li>
              </ul>
            </div>
          </div>

          <div class="row mt-3">
            <!-- Row 2, Column 1: FlexRadio -->
            <div class="col-md-6">
              <ul class="list-group">
                <li class="list-group-item d-flex">
                  <span class="label-text">FlexRadio:</span>
                  <span id="flexRadioStatus" class="status-item">Disconnected</span>
                </li>
              </ul>
            </div>

            <!-- Row 2, Column 2: WSJT-X Listener -->
            <div class="col-md-6">
              <ul class="list-group">
                <li class="list-group-item d-flex">
                  <span class="label-text">WSJT-X Listener:</span>
                  <span id="wsjtxListenerStatus" class="status-item">Unknown</span>
                </li>
              </ul>
            </div>
          </div>

          <!-- Most Recent Spot Section -->
          <h3 class="mt-4">Most Recent Spot</h3>
          <ul id="spotsList" class="list-group">
            <li class="list-group-item d-flex align-items-center">
              <div>Unknown</div>
            </li>
          </ul>

          <!-- Cache Health Section -->
          <h3 class="mt-4">Wavelog Augmented Spot Data Cache Health</h3>
          <ul class="list-group">
            <li class="list-group-item">
              <span id="cacheHealth" class="status-item">Uninitialized</span>
            </li>
          </ul>
        </div>
      </div>

      
      <!-- Configuration Tab -->
      <div
        class="tab-pane fade"
        id="config"
        role="tabpanel"
        aria-labelledby="config-tab"
      >
        <!-- Configuration Content -->
        <div id="configContent" class="mt-4">
          <form id="configForm">

            <!-- Form Action Buttons -->
            <button type="submit" class="btn btn-primary">Save Configuration</button>
            <button type="button" id="resetDefaults" class="btn btn-warning ms-2">Reset to Defaults</button>

            <!-- HTTP CAT Listener -->
            <h4 class="mt-4">Wavelog "Click-to-Tune" Listener</h4>
            
            <div class="mb-3">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="catListenerEnabled">
                <label class="form-check-label fw-bold" for="catListenerEnabled">Enable Local Callback Listener</label>
              </div>
              <div class="form-text text-muted">
                This enables the <strong>Callback URL</strong> feature. When enabled, clicking a spot in the Wavelog Bandmap/Cluster will instantly tune your FlexRadio to that frequency.
              </div>
            </div>

              <div class="row">
                <div class="col-md-8 mb-3">
                    <label for="catListenerHost" class="form-label">Listener Host (IP)</label>
                    <input type="text" class="form-control" id="catListenerHost" placeholder="0.0.0.0">
                    <div class="form-text">
                        Recommended: <code>0.0.0.0</code> (Listen on all interfaces). Use this if your Wavelog is running on a different device (like a Raspberry Pi or whatever).
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="catListenerPort" class="form-label">Listener Port</label>
                    <input type="number" class="form-control" id="catListenerPort" placeholder="54321">
                    <div class="form-text">
                        Default: <code>54321</code>.
                    </div>
                </div>
            </div>

            <!-- Configuration Hint Box -->
            <div class="alert alert-info mt-2" role="alert">
                <i class="bi bi-info-circle-fill me-2"></i><strong>Wavelog Configuration Steps:</strong>
                <ol class="mb-0 ps-3 mt-1">
                    <li>
                        In Wavelog <em>Settings -> Hardware Interfaces</em>: Set <strong>Radio Interface</strong> to <code class="user-select-all">http://127.0.0.1:54321</code>
                    </li>
                    <li>
                        <strong>IMPORTANT:</strong> In the Wavelog <strong>DX Cluster / QSO Panel</strong>, you must click the <strong>"CAT Connection"</strong> button so it turns <span class="text-success fw-bold">GREEN</span>.
                    </li>
                </ol>
            </div>
  
          <!-- Wavelog Live Integration Settings -->
            <h4 class="mt-4">Wavelog Live Integration</h4>
            <div class="alert alert-secondary p-2 small">
                <i class="bi bi-info-circle me-1"></i>
                This service allows real-time frequency sync and provides metadata (Name, QTH, Bearing) to the <strong>QSO Assistant</strong>.
            </div>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="wavelogLivePort" class="form-label">WebSocket Port</label>
                    <input type="number" class="form-control" id="wavelogLivePort" placeholder="54322">
                    <div class="form-text">
                        Default: <code>54322</code>. Only change if this port is occupied by another app.
                    </div>
                </div>
            </div>

            <!-- Application Settings -->
            <h4 class="mt-4">Application General Settings</h4>
            
            <div class="row">

            <!-- Startup & Tray Behavior -->
            <div class="row mb-3">
              <div class="col-md-4">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appStartAtLogin">
                  <label class="form-check-label" for="appStartAtLogin">Start at Login</label>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appStartMinimized">
                  <label class="form-check-label" for="appStartMinimized">Start Minimized</label>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appMinimizeToTray">
                  <label class="form-check-label" for="appMinimizeToTray">Minimize to Tray</label>
                </div>
              </div>
            </div>

              <!-- Theme -->
              <div class="col-md-6 mb-3">
                <label for="appTheme" class="form-label">Theme</label>
                <select class="form-select" id="appTheme">
                  <option value="system">System Default</option>
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                </select>
              </div>
              
              <!-- Startup Tab -->
              <div class="col-md-6 mb-3">
                <label for="appStartupTab" class="form-label">Startup Tab</label>
                <select class="form-select" id="appStartupTab">
                  <option value="status">Status</option>
                  <option value="config">Configuration</option>
                  <option value="profiles">Profiles</option>
                  <option value="about">About</option>
                </select>
              </div>
            </div>

            <!-- Imperial Units (The Oddities) -->
            <div class="mb-4">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appUseImperial">
                  <label class="form-check-label fw-bold" for="appUseImperial">Use Imperial Units</label>
                </div>
                <div class="form-text text-muted small mt-1">
                    Activate if you live in one of the three countries on Earth that still insist on using miles, Fahrenheit and other imperial oddities. 
                    Everyone else can safely leave this as not activated and enjoy Metric (km).
                </div>
            </div>

            <!-- QSO Assistant Settings -->
            <h5 class="mt-4">QSO Assistant Settings</h5>
            <div class="row mb-3">
              <div class="col-md-6">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appShowQsoMedia">
                  <label class="form-check-label" for="appShowQsoMedia">Show Profile Image & Map</label>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appAutoLogQso">
                  <label class="form-check-label" for="appAutoLogQso">Auto-Log to Wavelog on Enter</label>
                </div>
              </div>
            </div>

            <!-- Compact Mode & Auto Open -->
            <div class="row mb-3">
              <div class="col-md-6">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appCompactMode">
                  <label class="form-check-label" for="appCompactMode">Compact Mode (Hide Banner)</label>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-check form-switch">
                  <input class="form-check-input" type="checkbox" id="appAutoOpenQSO">
                  <label class="form-check-label" for="appAutoOpenQSO">Auto-open QSO Assistant on start</label>
                </div>
              </div>
            </div>

            <!-- Window Sizes -->
            <h5 class="mt-3">Window Sizes</h5>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Main Window (Width x Height)</label>
                <div class="input-group">
                  <input type="number" class="form-control" id="appWindowWidth" placeholder="W">
                  <span class="input-group-text">x</span>
                  <input type="number" class="form-control" id="appWindowHeight" placeholder="H">
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">QSO Assistant (Width x Height)</label>
                <div class="input-group">
                  <input type="number" class="form-control" id="qsoWindowWidth" placeholder="W">
                  <span class="input-group-text">x</span>
                  <input type="number" class="form-control" id="qsoWindowHeight" placeholder="H">
                </div>
              </div>
            </div>

            <!-- Rotator Control -->
            <h4 class="mt-4">Rotator Control</h4>

            <div class="mb-3 text-muted small">
                Designed for <strong>RemoteQTH.com Simple Rotator Interface V</strong> via MQTT.
                <a href="https://remoteqth.com/" target="_new" class="text-decoration-none ms-1">
                    <i class="bi bi-box-arrow-up-right"></i> Visit Manufacturer
                </a>
            </div>
            
            <div class="mb-3">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="rotatorEnabled">
                <label class="form-check-label" for="rotatorEnabled">Enable Rotator Integration (MQTT)</label>
              </div>
            </div>
            
            <!-- MQTT Settings -->
            <div class="p-3 mb-3 border rounded">
                <div class="row">
                    <div class="col-md-8 mb-2">
                        <label class="form-label small fw-bold">Broker Host (IP)</label>
                        <input type="text" class="form-control form-control-sm" id="rotMqttHost" placeholder="e.g. 192.168.1.50">
                    </div>
                    <div class="col-md-4 mb-2">
                        <label class="form-label small fw-bold">Port</label>
                        <input type="number" class="form-control form-control-sm" id="rotMqttPort" value="1883">
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 mb-2">
                        <label class="form-label small fw-bold">Username</label>
                        <input type="text" class="form-control form-control-sm" id="rotMqttUser" placeholder="home">
                    </div>
                    <div class="col-md-6 mb-2">
                        <label class="form-label small fw-bold">Password</label>
                        <input type="password" class="form-control form-control-sm" id="rotMqttPass">
                    </div>
                </div>
                <div class="mb-2">
                    <label class="form-label small fw-bold">Topic Prefix</label>
                    <input type="text" class="form-control form-control-sm" id="rotMqttTopic" placeholder="SM6KZW/0/ROT">
                    <div class="form-text small">Do not include trailing slash. Logic appends '/set_azimuth'.</div>
                </div>
            </div>

            <!-- QRZ.com Configuration -->
            <h4 class="mt-4">QRZ.com Integration (XML Data)</h4>
            <div class="mb-3">
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="qrzEnabled">
                <label class="form-check-label" for="qrzEnabled">Enable QRZ.com Lookup (Required for precise bearing)</label>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="qrzUsername" class="form-label">Username</label>
                <input type="text" class="form-control" id="qrzUsername" placeholder="QRZ Username">
              </div>
              <div class="col-md-6 mb-3">
                <label for="qrzPassword" class="form-label">Password</label>
                <input type="password" class="form-control" id="qrzPassword" placeholder="QRZ Password">
              </div>
            </div>
            
            <hr class="my-4">          
            
            <!-- Augmented Spot Cache -->
            <h4 class="mt-4">Augmented Spot Cache</h4>
            <div class="mb-3">
              <label for="augmentedSpotCacheMaxSize" class="form-label">Max Cache Size</label>
              <input type="number" class="form-control" id="augmentedSpotCacheMaxSize" min="1" required placeholder="Enter maximum cache size e.g. 500" />
            </div>
  
            <!-- DX Cluster Configuration -->
            <h4 class="mt-4">DX Cluster Configuration</h4>
            <div class="mb-3">
              <label for="dxClusterHost" class="form-label">Host</label>
              <input type="text" class="form-control" id="dxClusterHost" required placeholder="e.g., dxc.mx0nca.uk" />
            </div>
            <div class="mb-3">
              <label for="dxClusterPort" class="form-label">Port</label>
              <input type="number" class="form-control" id="dxClusterPort" min="1" required placeholder="e.g., 7373" />
            </div>
            <div class="mb-3">
              <label for="dxClusterCallsign" class="form-label">Callsign</label>
              <input type="text" class="form-control" id="dxClusterCallsign" required placeholder="Your Callsign" />
            </div>
            <div class="mb-3">
              <label for="dxClusterLoginPrompt" class="form-label">Login Prompt (usually login:)</label>
              <input type="text" class="form-control" id="dxClusterLoginPrompt" placeholder="e.g., login:" />
            </div>
            <div class="mb-3">
              <label for="dxClusterCommandsAfterLogin" class="form-label">Commands After Login (comma separated)</label>
              <textarea class="form-control" id="dxClusterCommandsAfterLogin" rows="3" placeholder="SET/NAME YOURNAME, SET/QTH YOURCITY"></textarea>
            </div>
            <h5 class="mt-3">DX Cluster Reconnect Settings</h5>
            <div class="mb-3">
              <label for="dxClusterReconnectInitialDelay" class="form-label">Initial Delay (ms)</label>
              <input type="number" class="form-control" id="dxClusterReconnectInitialDelay" min="0" required placeholder="e.g., 1000" />
            </div>
            <div class="mb-3">
              <label for="dxClusterReconnectMaxDelay" class="form-label">Max Delay (ms)</label>
              <input type="number" class="form-control" id="dxClusterReconnectMaxDelay" min="0" required placeholder="e.g., 30000" />
            </div>
            <div class="mb-3">
              <label for="dxClusterReconnectBackoffFactor" class="form-label">Backoff Factor</label>
              <input type="number" step="0.1" class="form-control" id="dxClusterReconnectBackoffFactor" min="0" required placeholder="e.g., 2.0" />
            </div>
  
            <!-- FlexRadio Configuration -->
            <h4 class="mt-4">FlexRadio Configuration</h4>
            <div class="mb-3">
              <label for="flexRadioEnabled" class="form-label">Enabled</label>
              <select class="form-select" id="flexRadioEnabled" name="flexRadioEnabled" required>
                <option value="true">True</option>
                <option value="false">False</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="flexRadioHost" class="form-label">Host</label>
              <input type="text" class="form-control" id="flexRadioHost" placeholder="e.g., 192.168.1.100" />
            </div>
            <div class="mb-3">
              <label for="flexRadioPort" class="form-label">Port</label>
              <input type="number" class="form-control" id="flexRadioPort" min="1" placeholder="e.g., 4992" />
            </div>
            <div class="mb-3">
              <label for="flexRadioCommandTimeout" class="form-label">Command Timeout (ms)</label>
              <input type="number" class="form-control" id="flexRadioCommandTimeout" min="0" placeholder="e.g., 5000" />
            </div>
  
            <!-- Spot Management -->
            <h5 class="mt-4">Spot Management</h5>
            <div class="mb-3">
              <label for="spotManagementLifetimeSeconds" class="form-label">Lifetime Seconds</label>
              <input type="number" class="form-control" id="spotManagementLifetimeSeconds" min="1" required placeholder="e.g., 3600" />
            </div>
            <div class="mb-3">
              <label for="spotManagementCleanupIntervalSeconds" class="form-label">Cleanup Interval Seconds</label>
              <input type="number" class="form-control" id="spotManagementCleanupIntervalSeconds" min="1" required placeholder="e.g., 600" />
            </div>
  
            <!-- Spot Management Colors -->
            <h6 class="mt-4">Spot Management Colors</h6>
          
            <div>Select the colors for the spots using the color pickers below.</div>
            <div>&nbsp;</div>
            <!-- Default Colors -->
            <div class="mb-3">
              <label for="colorDefaultTextColor" class="form-label">Default Text Color</label>
              <input type="color" class="form-control form-control-color" id="colorDefaultTextColor" />
            </div>
            <div class="mb-3">
              <label for="colorDefaultBackgroundColor" class="form-label">Default Background Color</label>
              <input type="color" class="form-control form-control-color" id="colorDefaultBackgroundColor" />
            </div>
            <!-- My Callsign Colors -->
            <div class="mb-3">
              <label for="colorMyCallsignTextColor" class="form-label">My Callsign Text Color</label>
              <input type="color" class="form-control form-control-color" id="colorMyCallsignTextColor" />
            </div>
            <div class="mb-3">
              <label for="colorMyCallsignBackgroundColor" class="form-label">My Callsign Background Color</label>
              <input type="color" class="form-control form-control-color" id="colorMyCallsignBackgroundColor" />
            </div>
            <!-- DXCC Needed Colors -->
            <div class="mb-3">
              <label for="colorDxccNeededTextColor" class="form-label">DXCC Needed Text Color</label>
              <input type="color" class="form-control form-control-color" id="colorDxccNeededTextColor" />
            </div>
            <div class="mb-3">
              <label for="colorDxccNeededBackgroundColor" class="form-label">DXCC Needed Background Color</label>
              <input type="color" class="form-control form-control-color" id="colorDxccNeededBackgroundColor" />
            </div>
            <!-- DXCC Needed Band Colors -->
            <div class="mb-3">
              <label for="colorDxccNeededBandTextColor" class="form-label">DXCC Needed Band Text Color</label>
              <input type="color" class="form-control form-control-color" id="colorDxccNeededBandTextColor" />
            </div>
            <div class="mb-3">
              <label for="colorDxccNeededBandBackgroundColor" class="form-label">DXCC Needed Band Background Color</label>
              <input type="color" class="form-control form-control-color" id="colorDxccNeededBandBackgroundColor" />
            </div>
            <!-- DXCC Needed Band Mode Colors -->
            <div class="mb-3">
              <label for="colorDxccNeededBandModeTextColor" class="form-label">DXCC Needed Band Mode Text Color</label>
              <input type="color" class="form-control form-control-color" id="colorDxccNeededBandModeTextColor" />
            </div>
            <div class="mb-3">
              <label for="colorDxccNeededBandModeBackgroundColor" class="form-label">DXCC Needed Band Mode Background Color</label>
              <input type="color" class="form-control form-control-color" id="colorDxccNeededBandModeBackgroundColor" />
            </div>
            <!-- Call Confirmed Opacity Sliders -->
            <div class="mb-3">
              <label for="callConfirmedOpacity" class="form-label">Call Confirmed Opacity (%)</label>
              <div class="d-flex align-items-center">
                <input type="range" class="form-range me-3" id="callConfirmedOpacity" min="0" max="100" step="1" />
                <span id="callConfirmedOpacityValue">40%</span>
              </div>
            </div>
            <div class="mb-3">
              <label for="callConfirmedBandOpacity" class="form-label">Call Confirmed on Actual Band Opacity (%)</label>
              <div class="d-flex align-items-center">
                <input type="range" class="form-range me-3" id="callConfirmedBandOpacity" min="0" max="100" step="1" />
                <span id="callConfirmedBandOpacityValue">40%</span>
              </div>
            </div>
            <div class="mb-3">
              <label for="callConfirmedBandModeOpacity" class="form-label">Call Confirmed on Actual Band and Mode Opacity (%)</label>
              <div class="d-flex align-items-center">
                <input type="range" class="form-range me-3" id="callConfirmedBandModeOpacity" min="0" max="100" step="1" />
                <span id="callConfirmedBandModeOpacityValue">40%</span>
              </div>
            </div>
            <!-- Worked Before Opacity Sliders -->
            <div class="mb-3">
              <label for="callWorkedOpacity" class="form-label">Worked Before Opacity (%)</label>
              <div class="d-flex align-items-center">
                <input type="range" class="form-range me-3" id="callWorkedOpacity" min="0" max="100" step="1" />
                <span id="callWorkedOpacityValue">40%</span>
              </div>
            </div>
            <div class="mb-3">
              <label for="callWorkedBandOpacity" class="form-label">Worked Before on Actual Band Opacity (%)</label>
              <div class="d-flex align-items-center">
                <input type="range" class="form-range me-3" id="callWorkedBandOpacity" min="0" max="100" step="1" />
                <span id="callWorkedBandOpacityValue">40%</span>
              </div>
            </div>
            <div class="mb-3">
              <label for="callWorkedBandModeOpacity" class="form-label">Worked Before on Actual Band and Mode Opacity (%)</label>
              <div class="d-flex align-items-center">
                <input type="range" class="form-range me-3" id="callWorkedBandModeOpacity" min="0" max="100" step="1" />
                <span id="callWorkedBandModeOpacityValue">40%</span>
              </div>
            </div>
            <!-- Not LoTW Text Color -->
            <div class="mb-3">
              <label for="colorNotLotwTextColor" class="form-label">Not LoTW Text Color</label>
              <input type="color" class="form-control form-control-color" id="colorNotLotwTextColor" />
            </div>
  
            <!-- Wavelog API Configuration -->
            <h4 class="mt-4">Wavelog API Configuration</h4>
            <div class="mb-3">
              <label for="wavelogApiUrl" class="form-label">BASE URL (Keep the /index.php at the end unless you have <a target="_new" href="https://github.com/wavelog/Wavelog/wiki/Wavelog.php-Configuration-File">modified Wavelogs .htaccess</a>)</label>
              <input type="url" class="form-control" id="wavelogApiUrl" required placeholder="https://wavelog.example.com/index.php" />
            </div>
            <div class="mb-3">
              <label for="wavelogApiKey" class="form-label">API Key</label>
              <input type="text" class="form-control" id="wavelogApiKey" required placeholder="Your API Key" />
            </div>
            <div class="mb-3">
              <label for="stationLocationIds" class="form-label">Station Location IDs (comma separated)</label>
              <input type="text" class="form-control" id="stationLocationIds" placeholder="e.g., 1,3" />
            </div>
            <div class="mb-3">
              <label for="wavelogRadioName" class="form-label">Radio name in Wavelog</label>
              <input type="text" class="form-control" id="wavelogRadioName" placeholder="wave-flex-integrator" />

              <!-- Checkbox for enabling multiflex support -->
              <label for="multiFlexEnabled">Enable MultiFlex Support:</label>
              <input type="checkbox" id="multiFlexEnabled" name="multiFlexEnabled">
            </div>
  
            <!-- LoTW Configuration -->
            <h4 class="mt-4">Logbook of The World (LoTW)</h4>
            <div class="mb-3">
              <label for="maxDaysConsideredTrue" class="form-label">Max Days for LoTW Consideration</label>
              <input type="number" class="form-control" id="maxDaysConsideredTrue" min="1" required placeholder="e.g., 200" />
            </div>

            <!-- WSJT-X Configuration -->
            <h4 class="mt-4">WSJT-X Configuration</h4>
            <div class="mb-3">
              <label for="wsjtEnabled" class="form-label">WSJT-X Integration Enabled</label>
              <select class="form-select" id="wsjtEnabled" name="wsjtEnabled" required>
                <option value="true">True</option>
                <option value="false">False</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="wsjtPort" class="form-label">UDP Listen Port</label>
              <input type="number" class="form-control" id="wsjtPort" min="1" required placeholder="e.g., 2237" />
            </div>
            <div class="mb-3">
              <label for="wsjtShowQSO" class="form-label">Show ongoing WSJT-X QSO in Wavelog live logging</label>
              <select class="form-select" id="wsjtShowQSO" name="wsjtShowQSO" required>
                <option value="true">True</option>
                <option value="false">False</option>
              </select>
            </div>
            <div class="mb-3">
              <label for="wsjtLogQSO" class="form-label">Log WSJT-X QSO in Wavelog</label>
              <select class="form-select" id="wsjtLogQSO" name="wsjtLogQSO" required>
                <option value="true">True</option>
                <option value="false">False</option>
              </select>
            </div>
  
            <!-- Form Action Buttons -->
            <button type="submit" class="btn btn-primary">Save Configuration</button>
            <button type="button" id="resetDefaults" class="btn btn-warning ms-2">Reset to Defaults</button>
          </form>
        </div>
      </div>

      <!-- Security Tab -->
      <div
        class="tab-pane fade"
        id="security"
        role="tabpanel"
        aria-labelledby="security-tab"
      >
        <div id="securityContent" class="mt-4">
          <h3>Security & HTTPS Connection</h3>
          <p>If you access Wavelog via <strong>HTTPS</strong>, your browser may block the connection to this local integrator for security reasons. Follow the steps below to establish a trusted connection.</p>

          <div class="card border-primary mb-4">
            <div class="card-header bg-primary text-white">
              <i class="bi bi-shield-check me-2"></i>Step 1: Install Local Certificate
            </div>
            <div class="card-body">
              <p>Click the button below to install the Wave-Flex security certificate into the Windows Trusted Root store. This allows Chrome and Edge to trust the connection.</p>
              <button id="installCertBtn" class="btn btn-primary">Install Local Certificate</button>
            </div>
          </div>

          <div class="card border-warning mb-4">
            <div class="card-header bg-warning text-dark fw-bold">
              <i class="bi bi-check-all me-2"></i>Step 2: Verify Connection (Required for Firefox)
            </div>
            <div class="card-body">
              <p class="text-body">
                To finalize the setup, click the buttons below to verify the connection. 
                <strong>Firefox users MUST</strong> do this to add a security exception.
              </p>
              
              <div class="d-grid gap-2 col-md-10 mx-auto">
                <a href="https://127.0.0.1:54321" target="_new" class="btn btn-outline-info btn-sm text-start">
                   1. Verify CAT Port 54321
                </a>
                <a href="https://127.0.0.1:54323" target="_new" class="btn btn-outline-info btn-sm text-start">
                   2. Verify WSS Port 54323
                </a>
              </div>

              <p class="mt-3 mb-0 small text-muted">
                <strong>Chrome/Edge:</strong> If you see "Verified", you are done. <br>
                <strong>Firefox:</strong> If you see a warning, click <strong>"Advanced..."</strong> and <strong>"Accept the Risk"</strong> until you see the "Verified" message.
              </p>
            </div>
          </div>

          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            <strong>Note:</strong> You only need to perform these steps once. After completion, please restart your browser for the changes to take effect.
          </div>
        </div>
      </div>

      <!-- Profiles Tab -->
      <div
        class="tab-pane fade"
        id="profiles"
        role="tabpanel"
        aria-labelledby="profiles-tab"
      >
        <div id="profilesContent" class="mt-3">
          <!-- Grid Container -->
          <div id="profilesGrid" class="container-fluid p-0">
            <div class="text-center text-muted mt-5">
               <div class="spinner-border text-secondary" role="status"></div>
               <div>Waiting for data...</div>
            </div>
          </div>
        </div>
      </div>

      <!-- About Tab -->
      <div
        class="tab-pane fade"
        id="about"
        role="tabpanel"
        aria-labelledby="about-tab"
      >
        <!-- About Content -->
        <div id="aboutContent" class="mt-4">
          
          <!-- Header Section -->
          <div class="d-flex align-items-center mb-4">
            <img src="assets/icons/icon.png" alt="Logo" style="width: 64px; height: 64px;" class="me-3">
            <div>
              <h2 class="mb-0">Wave-Flex Integrator</h2>
              <p class="text-muted mb-0">Version <span id="appVersion">1.0.8</span></p>
            </div>
          </div>

          <p><strong>Description:</strong> Wave-Flex Integrator simplifies your ham radio setup by directly connecting your **FlexRadio** to the **Wavelog** web-based logging software. It integrates DX Cluster data, enhances spot information, enables click-to-tune, and synchronizes your frequency and mode, all without the need for traditional CAT software.</p>

          <hr class="my-4">

          <!-- Wavelog Station Info -->
          <h5><i class="bi bi-broadcast me-2"></i>Wavelog Station Location</h5>
          <div class="card mb-4 bg-light-subtle">
            <div class="card-body font-monospace small">
              <span id="wavelogStationLocationDetails">Waiting for Wavelog connection...</span>
            </div>
          </div>

          <!-- Community Call to Action -->
          <div class="card border-primary mb-4">
            <div class="card-header bg-primary text-white">
              <i class="bi bi-heart-fill me-2"></i>Help the Project
            </div>
            <div class="card-body">
              <h5 class="card-title">Do you like this integration?</h5>
              <p class="card-text">
                Wave-Flex Integrator is a free, open-source project developed independently by the TNXQSO community.
              </p>
              <p class="card-text">
                If this tool has improved your operating experience, <strong>please consider spreading the word!</strong> Mentioning Wave-Flex Integrator on the <em>FlexRadio Community Forum</em>, Twitter/X, or to your fellow ham operators helps others discover that they can run Wavelog without complex CAT bridges.
              </p>
              <div class="d-flex gap-2">
                <a href="https://community.flexradio.com/" target="_new" class="btn btn-outline-primary btn-sm">
                  <i class="bi bi-chat-quote-fill me-1"></i> FlexRadio Forum
                </a>
                <a href="https://github.com/tnxqso/wave-flex-integrator" target="_new" class="btn btn-dark btn-sm">
                  <i class="bi bi-github me-1"></i> Star on GitHub
                </a>
              </div>
            </div>
          </div>

          <!-- Credits & Links -->
          <h5>Credits</h5>
          <ul class="list-unstyled">
            <li><strong>Author:</strong> <a target="_new" href="https://github.com/tnxqso">TNX QSO Community</a></li>
            <li><strong>Support:</strong> <a href="https://github.com/tnxqso/wave-flex-integrator/blob/main/README.md" target="_new">README & Documentation</a></li>
            <li><strong>License:</strong> <a target="_new" href="https://opensource.org/license/mit">MIT License</a></li>
          </ul>
          
          <div class="text-center mt-4 text-muted small">
            <em>Not affiliated with FlexRadio Systems or Wavelog.</em>
          </div>
        </div>

    </div>
  </div>

<!-- Update Notification Toast -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
      <div id="updateToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <strong class="me-auto text-primary">Update Ready</strong>
          <small>Just now</small>
          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
          A new version has been downloaded and is ready to install.
          <div class="mt-2 pt-2 border-top">
            <button type="button" id="restartAndInstallBtn" class="btn btn-primary btn-sm">Restart & Install</button>
            <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="toast">Later</button>
          </div>
        </div>
      </div>
    </div>

  </div> <!-- End of container-fluid -->

  <!-- Include Bootstrap JS from CDNJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js" integrity="sha512-VK2zcvntEufaimc+efOYi622VN5ZacdnufnmX7zIhCPmjhKnOi9ZDMtg1/ug5l183f19gG1/cBstPO4D8N/Img==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- Include renderer script -->
  <script src="renderer.js"></script>
</body>
</html>